<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ks43team02.mapper.WorkSystemMapper">
	<resultMap type="WorkSystem" id="WorkSystemMap">
		<result column="standard_work_code" 		property="standardWorkCode"/>
		<result column="cp_representative_code" 	property="cpRepresentativeCode"/>
		<result column="super_admin_id" 			property="superAdminId"/>
		<result column="worksystem_name" 			property="worksystemName"/>
		<result column="reg_user"					property="regUser"/>
		<result column="reg_date" 					property="regDate"/>
	</resultMap>
	<select id="getWorkSystem"  resultMap="WorkSystemMap">
		/* 근무제 기준 테이블 가져오기 */
		SELECT
			ws.standard_work_code
			,ws.cp_representative_code
			,ws.super_admin_id
			,ws.worksystem_name
			,ws.reg_user
			,ws.reg_date
		FROM
		tb_worksystem_standard AS ws;
	</select>
	<insert id="addWorkSystem" parameterType="WorkSystem">
		/*근무제리스트 추가*/
		INSERT INTO
			tb_worksystem_standard
			(
			
			standard_work_code
			,cp_representative_code
			,super_admin_id
			,worksystem_name
			,reg_user
			,reg_date
			
			)VALUES(
			
			(SELECT CONCAT('standard_work_code_',(SELECT(Max(cast(SUBSTRING_INDEX(standard_work_code,'_',-1) AS UNSIGNED)) +1)
			from
			tb_worksystem_standard
			w)))
			
			, #{cpRepresentativeCode}
			, #{superAdminId}
			, #{worksystemName}
			, '백민주'
			, NOW()
			);
			</insert>
</mapper>