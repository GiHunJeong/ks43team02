<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ks43team02.mapper.BoardMapper">
	<resultMap type="NoticeBoard" id="noticeBoardResultMap"						 >
		<id 	column="cp_notice_code" 		property="cpNoticeCode"		 	/>
		<result column="cp_representative_code" property="cpRepresentiveCode"	/>
		<result column="super_admin_id"			property="superAdminId"			/>
		<result column="notice_title"			property="noticeTitle"			/>
		<result column="notice_contents" 		property="noticeContents"		/>
		<result column="reg_user_name" 			property="regUserName"			/>
		<result column="reg_date" 				property="regDate"				/>
		<result column="modified_date" 			property="modifiedDate"			/>
		<result column="del_date"				property="delDate"				/>
		<result column="view_cnt" 				property="viewCnt"				/>
		<collection property="file" javaType="List" ofType="FileDto">
			<id 	column="attach_file_code" 			property="attachFileCode"/>
			<result	column="cp_representative_code" 	property="cpRepresentiveCode"/>
			<result column="super_admin_id" 			property="superAdminId"/>
			<result column="attach_file_original_name" 	property="attachFileOriginalName"/>
			<result column="attach_file_new_name" 		property="attachFileNewName"/>
			<result column="attach_file_path" 			property="attachFilePath"/>
			<result column="reg_user_name" 				property="regUserName"/>
			<result column="attach_file_size" 			property="attachFileSize"/>
			<result column="reg_date" 					property="regDate"/>
		</collection>
	</resultMap>
	
	
	<resultMap type="DepartmentBoard" 			id="departmentBoardResultMap"	 >
		<id		column="department_post_code"	property="departmentPostCode"	/>
		<result column="cp_representative_code"	property="cpRepresentiveCode"	/>
		<result column="super_admin_id"			property="superAdminId"			/>
		<result column="department_cate"		property="departmentCate"		/>
		<result column="emply_id"				property="emplyId"				/>
		<result column="reg_user_name"			property="regUserName"			/>
		<result column="post_title"				property="postTitle"			/>
		<result column="post_contents"			property="postContents"			/>
		<result column="reg_date"				property="regDate"				/>
		<result column="modified_date"			property="modifiedDate"			/>
		<result column="del_date"				property="delDate"				/>
		<result column="viewCnt"				property="viewCnt"				/>
	</resultMap>
	
	<select id="getDepartmentDetail" resultMap="departmentBoardResultMap">
		/* 부서별 게시판 게시글 조회 */
		SELECT
			department_post_code,
			cp_representative_code,
			super_admin_id,
			department_cate,
			emply_id,
			reg_user_name,
			post_title,
			post_contents,
			reg_date,
			modified_date,
			del_date,
			view_cnt
		FROM 
			tb_department_post
		WHERE
			tb_department_post.department_post_code = #{department_post_code};
	</select>
	
	<select id="getDepartmentBoardList" resultMap="departmentBoardResultMap">
		/* 부서별 게시판 목록 조회 */
		SELECT
			d.department_post_code,
			d.cp_representative_code,
			d.super_admin_id,
			d.department_cate,
			d.emply_id,
			d.reg_user_name,
			d.post_title,
			d.post_contents,
			d.reg_date,
			d.modified_date,
			d.del_date,
			d.view_cnt
		FROM
			tb_department_post AS d;
	</select>
	
	<insert id="addNotice">
		/* 공지사항 작성 */
		INSERT INTO tb_all_notice
			( cp_representative_code
			, super_admin_id
			, notice_title
			, notice_contents
			, reg_user_name
			, reg_date
			, modified_date
			, del_date
			, view_cnt)
		VALUES (
			 (SELECT 
			  	cp_representative_code
			  FROM
				tb_cp_representative
			 )
			,(SELECT 
			  super_admin_id
			  FROM
			  tb_super_admin
			 )
			, #{noticeTitle}
			, #{noticeContents}
			, #{regUserName}
			, CURDATE()
			, NULL
			, NULL
			, #{viewCnt});
	</insert>
	
	<select id="getNoticeDetail" resultMap="noticeBoardResultMap">
		/* 공지사항 게시글 조회 */
		SELECT
			cp_notice_code,
			cp_representative_code,
			super_admin_id,
			notice_title,
			notice_contents,
			reg_user_name,
			reg_date,
			modified_date,
			del_date,
			view_cnt
		FROM 
			tb_all_notice
		WHERE
			tb_all_notice.cp_notice_code = #{cp_notice_code};
	</select>
	
	<select id="getNoticeBoardList" resultMap="noticeBoardResultMap">
		/* 공지사항 목록 조회 */
		SELECT
			a.cp_notice_code,
			a.cp_representative_code,
			a.super_admin_id,
			a.notice_title,
			a.notice_contents,
			a.reg_user_name,
			a.reg_date,
			a.modified_date,
			a.del_date,
			a.view_cnt
		FROM
			tb_all_notice AS a;
	</select>
</mapper>